{% extends 'base.html' %}

{% block title %}Transaction History{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>Transaction History</h2>

    <div class="card">
        <div class="card-header">
            All Transactions (Newest First)
        </div>
        <div class="card-body">
            {% if transactions %}
            <table class="table table-striped table-hover table-sm">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Timestamp</th>
                        <th>User CNIC</th>
                        <th>User Name</th>
                        <th>Type</th>
                        <th>Amount</th>
                        <th>Description</th>
                        <th>Related User CNIC</th>
                        <th>Related User Name</th>
                    </tr>
                </thead>
                <tbody>
                    {% for trans in transactions %}
                    <tr>
                        <td>{{ trans.id }}</td>
                        <td>{{ trans.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</td>
                        <td>{{ trans.user.cnic }}</td>
                        <td>{{ trans.user.name }}</td>
                        <td>
                            {% if trans.transaction_type == 'credit' %}
                                <span class="badge badge-success">{{ trans.transaction_type|replace('_', ' ')|title }}</span>
                            {% elif trans.transaction_type == 'debit' %}
                                <span class="badge badge-danger">{{ trans.transaction_type|replace('_', ' ')|title }}</span>
                            {% elif trans.transaction_type == 'transfer_out' %}
                                <span class="badge badge-warning">{{ trans.transaction_type|replace('_', ' ')|title }}</span>
                            {% elif trans.transaction_type == 'transfer_in' %}
                                <span class="badge badge-info">{{ trans.transaction_type|replace('_', ' ')|title }}</span>
                            {% elif trans.transaction_type == 'profit_distribution' %}
                                <span class="badge badge-primary">{{ trans.transaction_type|replace('_', ' ')|title }}</span>
                            {% else %}
                                <span class="badge badge-secondary">{{ trans.transaction_type|replace('_', ' ')|title }}</span>
                            {% endif %}
                        </td>
                        <td>{{ "%.2f"|format(trans.amount) }}</td>
                        <td>{{ trans.description }}</td>
                        <td>{{ trans.related_user.cnic if trans.related_user else 'N/A' }}</td>
                        <td>{{ trans.related_user.name if trans.related_user else 'N/A' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p class="text-muted">No transactions recorded yet.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %} 